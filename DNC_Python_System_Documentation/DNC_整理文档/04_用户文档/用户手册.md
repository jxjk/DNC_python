# DNC系统用户手册

## 1. 系统概述

### 1.1 系统简介
DNC（Direct Numerical Control）系统是一个数控设备参数管理软件，用于从电脑直接传送参数到NC机的宏变量系统。该系统通过自动化参数计算和传输，显著提高NC机参数设置的效率和准确性。

### 1.2 主要功能
- **型号自动识别**: 支持QR码扫描和手动输入
- **参数自动计算**: 基于型号自动计算NC机参数
- **程序灵活切换**: 支持多程序显示和切换
- **数据验证**: 自动验证参数关系和范围
- **NC通信**: 支持多种NC协议的数据传输

### 1.3 适用场景
- 数控机床参数设置
- 产品型号参数管理
- 生产数据自动化传输
- 质量控制和参数验证

## 2. 系统安装

### 2.1 系统要求

#### 2.1.1 硬件要求
- **处理器**: Intel i3或同等性能以上
- **内存**: 4GB RAM（推荐8GB）
- **存储**: 500MB可用空间
- **显示器**: 1024×768分辨率以上
- **网络**: 100Mbps以太网（网络部署时）

#### 2.1.2 软件要求
- **操作系统**: Windows 10/11, Linux, macOS
- **Python**: 3.8或更高版本
- **其他**: 支持USB接口的QR码扫描器

### 2.2 安装步骤

#### 2.2.1 单机安装
1. 下载安装包
2. 运行安装程序
3. 按照向导完成安装
4. 配置系统参数
5. 启动系统

#### 2.2.2 网络安装
1. 服务器端安装
2. 客户端安装
3. 网络配置
4. 数据同步设置
5. 系统测试

### 2.3 首次配置

#### 2.3.1 基本配置
1. 设置操作员ID
2. 配置NC通信参数
3. 设置QR码识别模式
4. 配置数据文件路径

#### 2.3.2 设备连接
1. 连接QR码扫描器
2. 连接NC机床
3. 测试通信连接
4. 验证数据传输

## 3. 基本操作

### 3.1 系统启动

#### 3.1.1 启动方式
- **桌面快捷方式**: 双击桌面图标
- **开始菜单**: 从程序菜单启动
- **命令行**: 运行 `python main.py`

#### 3.1.2 登录界面
- 输入操作员ID
- 选择工作模式
- 确认系统状态

### 3.2 主界面介绍

#### 3.2.1 界面布局
```
┌─────────────────────────────────────────┐
│  菜单栏 [文件 编辑 视图 工具 帮助]        │
├─────────────────────────────────────────┤
│  工具栏 [扫描 计算 发送 设置 帮助]        │
├─────────────────────────────────────────┤
│  型号显示区                              │
│  ┌─────────────────────────────────────┐ │
│  │ 型号: [C-CCC10-20A-P5-30]           │ │
│  │ PO: [PO12345]   数量: [100]         │ │
│  └─────────────────────────────────────┘ │
├─────────────────────────────────────────┤
│  程序显示区                              │
│  ┌─────────────────────────────────────┐ │
│  │ 程序1 [程序A] 程序2 [程序B] 程序3 [程序C]│ │
│  └─────────────────────────────────────┘ │
├─────────────────────────────────────────┤
│  参数显示区                              │
│  ┌─────────────────────────────────────┐ │
│  │ #500: [10]                          │ │
│  │ #501: [size1]                       │ │
│  │ #502: [define1-1]                   │ │
│  │ ...                                 │ │
│  └─────────────────────────────────────┘ │
├─────────────────────────────────────────┤
│  状态栏 [就绪]                           │
└─────────────────────────────────────────┘
```

#### 3.2.2 功能区说明
- **菜单栏**: 系统功能菜单
- **工具栏**: 常用操作快捷按钮
- **型号显示区**: 显示当前处理的型号信息
- **程序显示区**: 显示匹配的程序列表
- **参数显示区**: 显示计算后的参数值
- **状态栏**: 显示系统状态和提示信息

### 3.3 型号输入

#### 3.3.1 QR码扫描输入
1. 点击"扫描"按钮或使用快捷键
2. 使用QR码扫描器扫描产品标签
3. 系统自动识别型号并显示
4. 验证识别结果是否正确

#### 3.3.2 手动输入
1. 点击型号显示区的输入框
2. 手动输入型号字符串
3. 按Enter键确认输入
4. 系统自动处理型号

#### 3.3.3 型号格式
- **标准格式**: `PO@型号@数量`
- **分隔符**: 可配置的分隔符（默认为@）
- **示例**: `PO12345@C-CCC10-20A-P5-30@100`

### 3.4 程序选择

#### 3.4.1 自动匹配
- 系统根据型号自动匹配程序
- 显示匹配的程序列表
- 默认选择第一个匹配程序

#### 3.4.2 手动选择
1. 点击程序显示区的程序按钮
2. 选择需要的程序
3. 系统重新计算参数
4. 更新参数显示

#### 3.4.3 程序切换
- 支持程序间的快速切换
- 保持参数计算的连续性
- 自动保存当前状态

### 3.5 参数操作

#### 3.5.1 参数查看
- 自动显示计算后的参数值
- 不同颜色标识参数类型
- 支持参数值的详细查看

#### 3.5.2 参数修改
1. 双击需要修改的参数
2. 输入新的参数值
3. 按Enter键确认修改
4. 系统重新验证参数

#### 3.5.3 参数验证
- 自动验证参数范围
- 检查参数间的关系
- 提示验证结果

## 4. 高级功能

### 4.1 批量处理

#### 4.1.1 批量型号输入
1. 准备型号列表文件
2. 导入型号列表
3. 系统自动批量处理
4. 生成处理报告

#### 4.1.2 批量参数计算
- 支持多个型号的连续计算
- 自动保存计算结果
- 生成参数汇总表

### 4.2 数据导出

#### 4.2.1 参数导出
1. 选择导出范围
2. 设置导出格式
3. 选择保存路径
4. 执行导出操作

#### 4.2.2 支持格式
- CSV格式
- Excel格式
- 文本格式
- XML格式

### 4.3 历史记录

#### 4.3.1 操作记录
- 自动记录用户操作
- 保存计算历史
- 支持历史查询

#### 4.3.2 数据追溯
- 记录参数修改历史
- 支持数据版本管理
- 提供审计日志

## 5. NC通信

### 5.1 通信设置

#### 5.1.1 协议配置
1. 选择NC协议类型
2. 配置通信参数
3. 测试通信连接
4. 保存配置

#### 5.1.2 支持协议
- Rexroth协议
- Brother协议
- Fanuc协议
- 自定义协议

### 5.2 数据传输

#### 5.2.1 手动发送
1. 计算完成参数
2. 点击"发送"按钮
3. 选择发送目标
4. 确认发送结果

#### 5.2.2 自动发送
- 配置自动发送条件
- 设置发送延迟
- 监控发送状态
- 处理发送异常

### 5.3 通信监控

#### 5.3.1 状态显示
- 实时显示通信状态
- 监控数据传输
- 显示错误信息

#### 5.3.2 故障处理
- 自动重试机制
- 错误日志记录
- 故障诊断提示

## 6. 系统设置

### 6.1 基本设置

#### 6.1.1 界面设置
- 语言选择
- 主题设置
- 字体大小
- 布局调整

#### 6.1.2 操作设置
- 快捷键配置
- 默认操作设置
- 确认对话框设置

### 6.2 数据设置

#### 6.2.1 文件路径
- 配置文件路径
- 数据文件路径
- 日志文件路径
- 备份文件路径

#### 6.2.2 数据管理
- 数据备份设置
- 数据恢复设置
- 数据清理设置

### 6.3 安全设置

#### 6.3.1 权限管理
- 用户权限设置
- 操作权限控制
- 数据访问权限

#### 6.3.2 审计设置
- 操作日志设置
- 审计跟踪设置
- 安全策略设置

## 7. 故障排除

### 7.1 常见问题

#### 7.1.1 型号识别问题
**问题**: 型号无法识别
**解决方案**:
1. 检查QR码格式是否正确
2. 验证系统配置参数
3. 检查型号定义文件
4. 查看错误日志

#### 7.1.2 参数计算问题
**问题**: 参数计算错误
**解决方案**:
1. 检查型号分割是否正确
2. 验证计算规则文件
3. 检查数据文件完整性
4. 查看计算日志

#### 7.1.3 通信问题
**问题**: NC通信失败
**解决方案**:
1. 检查物理连接
2. 验证通信参数
3. 测试通信协议
4. 查看通信日志

### 7.2 错误代码

#### 7.2.1 系统错误
- **E001**: 文件未找到
- **E002**: 数据格式错误
- **E003**: 配置错误
- **E004**: 权限错误

#### 7.2.2 计算错误
- **C001**: 型号识别失败
- **C002**: 程序匹配失败
- **C003**: 参数计算失败
- **C004**: 关系验证失败

#### 7.2.3 通信错误
- **N001**: 连接失败
- **N002**: 发送失败
- **N003**: 接收失败
- **N004**: 协议错误

### 7.3 维护建议

#### 7.3.1 日常维护
- 定期备份数据
- 检查系统日志
- 更新配置文件
- 清理临时文件

#### 7.3.2 性能优化
- 优化数据文件
- 清理历史记录
- 调整系统参数
- 监控系统资源

## 8. 附录

### 8.1 快捷键列表

#### 8.1.1 通用快捷键
- **Ctrl+N**: 新建
- **Ctrl+O**: 打开
- **Ctrl+S**: 保存
- **Ctrl+P**: 打印
- **F1**: 帮助

#### 8.1.2 操作快捷键
- **F2**: 扫描型号
- **F3**: 计算参数
- **F4**: 发送参数
- **F5**: 刷新显示
- **F12**: 系统设置

### 8.2 配置文件说明

#### 8.2.1 主要配置文件
- **ini.csv**: 系统配置
- **header.csv**: 前缀处理
- **type_define.csv**: 型号定义
- **type_prg.csv**: 程序映射
- **prg.csv**: 程序信息

#### 8.2.2 参数配置文件
- **load.csv**: 程序参数
- **cntrl.csv**: 控件定义
- **define.csv**: 变量定义
- **chngValue.csv**: 值转换
- **calc.csv**: 计算逻辑
- **relation.csv**: 关系验证

### 8.3 技术支持

#### 8.3.1 获取帮助
- 查看在线帮助
- 联系技术支持
- 访问用户论坛
- 查阅技术文档

#### 8.3.2 反馈建议
- 报告问题
- 提出改进建议
- 参与用户调查
- 贡献使用经验

---

**文档版本**: v1.0  
**最后更新**: 2025年10月24日  
**技术支持**: support@dnc-system.com  
**官方网站**: https://www.dnc-system.com
