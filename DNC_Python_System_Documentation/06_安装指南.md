# DNC参数计算系统 - 安装指南

## 系统要求

### 硬件要求
- **处理器**: Intel Core i5 或同等性能以上
- **内存**: 8GB RAM 或以上
- **硬盘空间**: 至少 1GB 可用空间
- **显示器**: 分辨率 1280x720 或更高

### 软件要求
- **操作系统**: Windows 10/11, Linux, macOS
- **Python版本**: 3.8 或更高版本
- **依赖包**: 详见 requirements.txt

## 安装步骤

### 方法一：从源码安装（推荐）

#### 1. 下载项目
```bash
# 从Git仓库克隆
git clone <repository-url>
cd DNC_Python_Project

# 或者下载ZIP包并解压
# 解压到 DNC_Python_Project 目录
```

#### 2. 安装Python依赖
```bash
# 使用pip安装依赖
pip install -r requirements.txt

# 或者使用conda环境
conda create -n dnc_system python=3.8
conda activate dnc_system
pip install -r requirements.txt
```

#### 3. 配置环境
```bash
# 创建必要的目录
mkdir -p logs output data/input

# 复制Master数据（如果已有）
cp -r /path/to/master/data/* data/master/
```

#### 4. 运行系统
```bash
# 直接运行Python脚本
python main.py

# 或者使用启动脚本
# Windows: 双击 run.bat
# Linux/macOS: ./run.sh
```

### 方法二：使用打包版本

#### 1. 下载发布包
- 从发布页面下载最新版本的打包文件
- 解压到目标目录

#### 2. 运行系统
```bash
# Windows
双击 DNC_System.exe

# Linux/macOS
./DNC_System
```

### 方法三：开发环境安装

#### 1. 设置开发环境
```bash
# 克隆项目
git clone <repository-url>
cd DNC_Python_Project

# 创建虚拟环境
python -m venv venv

# 激活虚拟环境
# Windows:
venv\Scripts\activate
# Linux/macOS:
source venv/bin/activate

# 安装开发依赖
pip install -r requirements-dev.txt
```

#### 2. 运行测试
```bash
# 运行单元测试
pytest tests/

# 运行集成测试
pytest tests/integration/

# 运行性能测试
python tests/performance_test.py
```

## 配置说明

### 配置文件位置
- 主配置文件: `config/config.ini`
- 应用程序配置: `config/app_config.ini`
- 日志配置: `config/logging.ini`

### 主要配置项

#### 应用程序配置
```ini
[APPLICATION]
name = DNC参数计算系统
version = 2.05
language = zh-CN
auto_save = true
backup_enabled = true
```

#### 路径配置
```ini
[PATHS]
master_directory = data/master
log_directory = logs
input_directory = data/input
output_directory = output
config_directory = config
```

#### 计算配置
```ini
[CALCULATION]
precision = 4
rounding_method = round
auto_validation = true
default_density = 1.0
```

## 数据文件准备

### Master数据文件
系统需要以下Master数据文件才能正常运行：

#### 必需文件
- `ini.csv` - 系统配置
- `header.csv` - 前缀处理规则
- `type_define.csv` - 产品类型定义
- `type_prg.csv` - 程序类型映射
- `prg.csv` - 程序定义
- `load.csv` - 主数据文件

#### 可选文件
- `calc.csv` - 计算定义
- `relation.csv` - 关系验证
- `define.csv` - 变量定义
- `cntrl_rex.csv` - 参数控制

### 数据文件位置
将所有Master数据文件放置在 `data/master/` 目录下。

## 首次运行设置

### 1. 启动应用程序
```bash
python main.py
```

### 2. 初始配置
- 系统会自动检测Master数据文件
- 如果缺少必需文件，会显示错误提示
- 按照提示补充缺失的文件

### 3. 验证安装
- 检查日志文件是否正常生成
- 测试基本功能是否正常
- 验证计算结果是否正确

## 故障排除

### 常见问题

#### 1. Python依赖安装失败
```bash
# 更新pip
python -m pip install --upgrade pip

# 使用国内镜像源
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple

# 或者使用conda
conda install --file requirements.txt
```

#### 2. 编码问题
```bash
# 设置系统编码
export PYTHONIOENCODING=utf-8

# Windows命令提示符
chcp 65001
```

#### 3. 权限问题
```bash
# Linux/macOS: 添加执行权限
chmod +x run.sh

# Windows: 以管理员身份运行
```

#### 4. 文件路径问题
- 确保所有路径使用正斜杠 (/)
- 避免使用中文路径
- 检查文件权限

### 日志文件检查
如果遇到问题，请检查日志文件：
- `logs/dnc_system.log` - 主日志文件
- `logs/error.log` - 错误日志

## 更新说明

### 版本升级
1. 备份现有数据和配置
2. 下载新版本
3. 替换程序文件
4. 恢复配置和数据
5. 测试功能

### 数据迁移
如果Master数据格式有变化：
1. 备份原有数据
2. 运行数据迁移脚本
3. 验证数据完整性

## 卸载说明

### 完全卸载
1. 删除项目目录
2. 删除虚拟环境（如果使用）
3. 清理系统临时文件

### 保留数据卸载
1. 备份 `data/` 和 `config/` 目录
2. 删除程序文件
3. 需要时恢复数据

## 技术支持

### 获取帮助
- 查看项目文档
- 检查常见问题解答
- 联系技术支持团队

### 报告问题
如果遇到问题，请提供：
1. 操作系统和Python版本
2. 错误日志内容
3. 重现步骤
4. 相关配置文件

---

**文档版本**: 1.0  
**最后更新**: 2025/10/23  
**支持邮箱**: support@dnc-system.com
