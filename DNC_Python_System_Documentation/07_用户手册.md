# DNC参数计算系统 - 用户手册

## 系统概述

### 系统简介
DNC参数计算系统是一个专业的数控设备参数管理软件，用于从电脑直接传送参数到NC机的宏变量系统。该系统能够自动计算和验证加工参数，提高生产效率和准确性。

### 主要功能
- **产品参数管理**: 管理不同产品型号的加工参数
- **自动计算**: 根据几何关系自动计算加工参数
- **程序生成**: 生成NC机可执行的程序代码
- **参数验证**: 验证参数的有效性和一致性
- **数据导出**: 导出计算结果和程序文件

## 快速入门

### 首次使用

#### 1. 启动系统
```bash
# 双击桌面快捷方式
# 或运行程序目录中的 DNC_System.exe
```

#### 2. 主界面介绍
- **顶部菜单栏**: 文件、编辑、视图、工具、帮助
- **左侧导航栏**: 产品类型、程序类型、参数设置
- **中央工作区**: 参数输入、计算结果、程序预览
- **底部状态栏**: 系统状态、操作提示

#### 3. 基本操作流程
1. 选择产品型号
2. 输入基本参数
3. 系统自动计算
4. 验证计算结果
5. 生成程序文件
6. 导出到NC机

## 详细功能说明

### 产品型号管理

#### 选择产品型号
1. 在左侧导航栏点击"产品类型"
2. 从下拉列表中选择产品型号
3. 系统自动加载对应的参数模板

#### 产品型号说明
- **GPA系列**: 标准齿轮产品
- **HPN系列**: 高精度齿轮产品
- **SPC系列**: 特殊齿轮产品

### 参数输入

#### 基本参数
- **齿数 (Teeth_num)**: 齿轮的齿数
- **模数 (Module)**: 齿轮的模数
- **压力角 (Pressure_angle)**: 齿轮的压力角
- **螺旋角 (Helix_angle)**: 齿轮的螺旋角

#### 几何参数
- **外径 (Outer_diameter)**: 齿轮的外径
- **根径 (Root_diameter)**: 齿轮的根径
- **基圆直径 (Base_diameter)**: 齿轮的基圆直径

#### 加工参数
- **切削速度 (Cutting_speed)**: 切削速度
- **进给量 (Feed_rate)**: 进给量
- **切削深度 (Cutting_depth)**: 切削深度

### 计算功能

#### 自动计算
系统根据输入的参数自动计算：
- 几何尺寸
- 加工参数
- 宏变量值

#### 手动计算
1. 点击"计算"按钮
2. 选择计算类型
3. 查看计算结果

#### 计算验证
系统自动验证：
- 参数的有效性
- 几何关系的一致性
- 加工参数的合理性

### 程序生成

#### 程序类型选择
- **程序1 (prg1)**: 标准加工程序
- **程序2 (prg2)**: 高精度加工程序
- **程序3 (prg3)**: 特殊加工程序

#### 程序预览
1. 点击"程序预览"按钮
2. 查看生成的程序代码
3. 检查程序逻辑

#### 程序导出
1. 点击"导出程序"按钮
2. 选择保存位置
3. 确认导出格式

## 操作指南

### 文件操作

#### 新建项目
1. 点击菜单"文件" → "新建"
2. 输入项目名称
3. 选择产品类型

#### 打开项目
1. 点击菜单"文件" → "打开"
2. 选择项目文件 (.dnc)
3. 系统加载项目数据

#### 保存项目
1. 点击菜单"文件" → "保存"
2. 输入文件名
3. 选择保存位置

#### 导出数据
1. 点击菜单"文件" → "导出"
2. 选择导出格式 (CSV, TXT, XML)
3. 选择保存位置

### 编辑操作

#### 参数编辑
1. 在参数表格中双击单元格
2. 输入新值
3. 按Enter键确认

#### 批量编辑
1. 选择多个参数
2. 右键点击选择"批量编辑"
3. 输入统一值或公式

#### 撤销/重做
- **撤销**: Ctrl+Z 或点击撤销按钮
- **重做**: Ctrl+Y 或点击重做按钮

### 视图操作

#### 界面布局
- **标准视图**: 显示所有功能面板
- **紧凑视图**: 隐藏部分面板
- **全屏视图**: 最大化工作区域

#### 数据显示
- **表格视图**: 以表格形式显示数据
- **表单视图**: 以表单形式显示数据
- **图表视图**: 以图表形式显示数据

#### 缩放控制
- **放大**: Ctrl++ 或点击放大按钮
- **缩小**: Ctrl+- 或点击缩小按钮
- **重置**: Ctrl+0 或点击重置按钮

## 高级功能

### 自定义计算

#### 添加自定义公式
1. 点击菜单"工具" → "公式编辑器"
2. 输入公式名称和表达式
3. 保存自定义公式

#### 使用自定义公式
1. 在参数输入界面
2. 选择自定义公式
3. 系统自动计算结果

### 批量处理

#### 批量计算
1. 准备参数文件 (CSV格式)
2. 点击菜单"工具" → "批量计算"
3. 选择参数文件
4. 系统批量处理并生成结果

#### 批量导出
1. 选择多个计算结果
2. 点击菜单"文件" → "批量导出"
3. 选择导出格式和位置

### 数据验证

#### 参数范围检查
系统自动检查：
- 数值范围是否合理
- 参数之间是否冲突
- 几何关系是否满足

#### 加工可行性检查
- 刀具是否可用
- 机床能力是否足够
- 加工时间是否合理

## 故障排除

### 常见问题

#### 系统无法启动
- 检查Python是否安装
- 检查依赖包是否完整
- 检查配置文件是否存在

#### 计算错误
- 检查输入参数是否完整
- 检查参数值是否合理
- 检查Master数据是否完整

#### 程序生成失败
- 检查程序模板是否存在
- 检查变量定义是否完整
- 检查权限是否足够

### 错误代码说明

#### E001: 文件不存在
- 原因: 必需的Master数据文件缺失
- 解决: 检查data/master目录下的文件

#### E002: 参数错误
- 原因: 输入参数无效或不完整
- 解决: 检查参数输入界面

#### E003: 计算失败
- 原因: 计算过程中出现错误
- 解决: 查看详细错误信息

#### E004: 程序生成错误
- 原因: 程序模板或变量错误
- 解决: 检查程序定义文件

### 性能优化

#### 提高计算速度
- 关闭不必要的功能
- 减少同时打开的文件
- 优化系统设置

#### 减少内存使用
- 定期清理缓存
- 关闭不需要的视图
- 优化数据加载

## 快捷键参考

### 文件操作
- **Ctrl+N**: 新建项目
- **Ctrl+O**: 打开项目
- **Ctrl+S**: 保存项目
- **Ctrl+Shift+S**: 另存为
- **Ctrl+P**: 打印

### 编辑操作
- **Ctrl+Z**: 撤销
- **Ctrl+Y**: 重做
- **Ctrl+C**: 复制
- **Ctrl+V**: 粘贴
- **Ctrl+X**: 剪切
- **Ctrl+A**: 全选

### 视图操作
- **F11**: 全屏切换
- **Ctrl++**: 放大
- **Ctrl+-**: 缩小
- **Ctrl+0**: 重置缩放

### 计算操作
- **F5**: 重新计算
- **F9**: 验证参数
- **F12**: 生成程序

## 技术支持

### 获取帮助
- **在线帮助**: 按F1键打开帮助文档
- **技术支持**: 联系技术支持团队
- **用户论坛**: 访问用户社区

### 报告问题
如果遇到问题，请提供：
1. 系统版本信息
2. 错误截图或日志
3. 操作步骤描述
4. 相关数据文件

### 更新检查
- 点击菜单"帮助" → "检查更新"
- 系统自动检查新版本
- 按照提示进行更新

---

**文档版本**: 1.0  
**最后更新**: 2025/10/23  
**技术支持**: support@dnc-system.com
